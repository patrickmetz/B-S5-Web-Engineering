<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ãœ 8.1</title>

    <script>
        const baseUrl = "./";
        const A = "A";
        const B = "B";
        const TYPE = ".txt";

        let lines = new Map;

        const fetchFileAsLines = (fileName) => {
            // every chain-step returns a promise
            return fetch(baseUrl + fileName)
                .then(response => response.text())
                .then(text => text.split("\n"));
        }

        const printLinesConcatenated = () => {
            let lengthA = lines.get(A).length;
            let lengthB = lines.get(B).length;

            const bigger = (lengthA >= lengthB) ? A : B;
            const smaller = (bigger === A) ? B : A;

            const biggerSize = (bigger === A) ? lengthA : lengthB;
            const smallerSize = (bigger === A) ? lengthB : lengthA;

            let body = document.getElementsByTagName("body")[0];
            let line = "";

            for (let lineIndex = 0; lineIndex < biggerSize; lineIndex++) {
                line = (lineIndex < smallerSize)
                    ? lines.get(bigger)[lineIndex] + lines.get(smaller)[lineIndex]
                    : lines.get(bigger)[lineIndex];

                let p = document.createElement("p")
                p.textContent = line;

                body.appendChild(p)
            }
        }

        Promise.all([ // returns a promise, too
            fetchFileAsLines(A + TYPE).then(_ => {lines.set(A, _)}),
            fetchFileAsLines(B + TYPE).then(_ => {lines.set(B, _)}),
        ]).then(() => {printLinesConcatenated()});
    </script>
</head>
<body>

</body>
</html>